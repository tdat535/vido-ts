const careers = [
    {
        animated_icon: "https://lottie.host/79c2b63a-756d-42cb-a166-3f0182fbaae7/LeRJtu9zz7.json",
        description: "Ăn uống là một nhu cầu thiết yếu của con người, cùng với đó, khi xã hội ngày càng phát triển thì nhu cầu đang ngày càng thay đổi. Bên cạnh đó, Việt Nam là một trong những quốc gia thu hút lượng lớn khách du lịch mỗi năm nhờ có nhiều địa danh hấp dẫn, món ăn độc đáo, v.v. Do đó phát sinh lượng lớn nhu cầu về dịch vụ nghỉ dưỡng và ăn uống. Điều này chứng tỏ, xã hội đang cần một lượng lớn nhân sự làm việc trong ngành chế biến đồ ăn, trong đó có nghề đầu bếp.",
        name: "Bếp",
        strength: "Sự sáng tạo: Một trong những điểm ưu tiên nhất của nghề đầu bếp là khả năng sáng tạo trong việc tạo ra những món ăn độc đáo. Đầu bếp có thể thử nghiệm với các thành phần, kỹ thuật nấu nướng và phong cách trình bày để tạo ra những món ăn mới mẻ và hấp dẫn cho thực đơn.\n Cơ hội học hỏi liên tục: Lĩnh vực ẩm thực luôn thay đổi và phát triển. Đầu bếp có cơ hội tham gia vào các khóa đào tạo, học viện nấu ăn và thậm chí là các cuộc thi nấu ăn để nâng cao kỹ năng và kiến ​​thức. Điều này giúp đầu bếp luôn nắm bắt được những xu hướng mới nhất trong ngành.\n Sở thích và đa dạng: Làm đầu bếp không bao giờ chán. Mỗi ngày, bạn sẽ làm việc với các nguyên liệu và công thức khác nhau. Bạn phải tạo nên những món ăn độc đáo và đa dạng. Việc của bạn là khám phá những hương vị mới và tạo ra những trải nghiệm ẩm thực độc đáo. Điều này sẽ làm cho công việc trở nên thú vị và kích thích.\nTạo ra niềm vui cho người khác: Một trong những điểm sáng nhất của nghề đầu bếp là khả năng tạo ra niềm vui và hạnh phúc cho người khác. Thông qua những món ăn ngon, bạn có thể giúp khách hàng vui vẻ. Mỗi khi khách hàng thưởng thức một món ăn ngon, đầu bếp sẽ cảm nhận được sự hài lòng và đánh giá cao về công việc của mình. ",
        type: "kitchen",
        url: "https://glints.com/vn/blog/hoc-dau-bep-o-dau/",
        weekness: "Áp lực công việc là một trong những ưu điểm và nhược điểm của nghề đầu bếp: Nghề đầu bếp yêu cầu sự chịu đựng áp lực cao. Trong nhà bếp, thời gian luôn là yếu tố quan trọng và đầu bếp thường phải làm việc trong điều kiện hạn chế về thời gian. Đồng thời, đầu bếp cũng phải đối mặt với áp lực từ khách hàng, đặc biệt là trong các nhà hàng cao cấp hoặc tiệc cưới.\nLàm việc trong điều kiện khó khăn: Nhà bếp có thể là một môi trường làm việc khá khắc nghiệt. Họ sẽ phải làm việc trong môi trường nhiệt độ cao, không gian căng thẳng và áp lực công việc có thể gây căng thẳng và mệt mỏi cho người làm bếp. Đối với những người đam mê nghề nấu ăn, điều này có thể không phải là một vấn đề lớn, nhưng với những người không đam mê, điều này có thể gây khó khăn và căng thẳng.\nThời gian làm việc không bình thường: Nghề đầu bếp thường yêu cầu làm việc vào buổi tối, cuối tuần và các ngày lễ. Điều này có thể gây khó khăn trong việc cân nhắc giữa công việc và cuộc sống của cá nhân. Đồng thời, làm việc trong những ca làm việc dài và không có thời gian nghỉ ngơi giải trí cũng có thể ảnh hưởng đến sức khỏe và sự cân bằng bằng cuộc sống của người đầu bếp.\nĐòi hỏi kỹ năng chuyên môn: Nghề đầu bếp không chỉ đơn giản là nấu ăn. Mà người nấu ăn còn phải học hỏi kiến ​​thức về nhiều lĩnh vực. Cụ thể như thực phẩm, kỹ thuật nấu nướng và quản lý nhà bếp. Để trở thành một đầu bếp giỏi, người ta cần phải bỏ ra nhiều thời gian. Bên cạnh đó, đầu bếp cần nỗ lực học hỏi và rèn luyện kỹ năng. "
    },
    {
        animated_icon: "https://lottie.host/a5bdda23-7eb4-4e22-aeb1-8abc0c68a0d1/kVfEkW4NNL.json",
        description: "Công nghệ Kỹ thuật ô tô là ngành học tích hợp kiến thức của nhiều lĩnh vực: Cơ khí, tự động hóa, điện – điện tử và công nghệ chế tạo máy, chuyên về lĩnh vực khai thác, sử dụng và dịch vụ kỹ thuật ô tô như: Điều hành sản xuất phụ tùng; điều kiện và lắp ráp ô tô; cải tiến, nâng cao hiệu quả sử dụng ô tô,…",
        name: "Ô tô",
        strength: "Sở hữu một thị trường tiềm năng lớn trong tương lai. \nMức thu nhập trung bình cao. \nNgành học luôn gắn liền với thực hành thực tiễn. \nKhông bị giới hạn bởi điều kiện tuyển chọn.",
        type: "car",
        url: "https://www.viendong.edu.vn/tim-hieu-ve-nganh-cong-nghe-o-to-la-gi-co-hoi-nghe-nghiep-muc-thu-nhap.html",
        weekness: "Cần sức khỏe tốt để theo nghề. \nMôi trường làm việc tương đối khắc nhiệt. \nTài liệu học tập chưa được chuẩn hóa. \nKiến thức học nghề phức tạp.",
    },
    {
        animated_icon: "https://lottie.host/42371d2a-4975-486d-a483-e146627c8636/fJnfefSgi6.json",
        description: "Kế toán (Accountant) là công việc ghi chép, thu nhận, xử lý và cung cấp các thông tin về tình hình hoạt động tài chính của một tổ chức, một doanh nghiệp, một cơ quan nhà nước, một cơ sở kinh doanh tư nhân... Đối tượng của Kế toán chính là sự hình thành, biến động của tài sản mà kế toán cần phản ánh, được thể hiện ở hai mặt là tài sản và nguồn vốn trong quá trình hoạt động của đơn vị.",
        name: "Kế toán",
        strength: "Kế toán đang có nhu cầu cao trong xã hội. \nTiềm năng cho sự tăng trưởng. \nTiền lương hậu hĩnh. \nĐa lĩnh vực. \nBạn không bị ràng buộc.",
        type: "accountant",
        url: "https://www.viendong.edu.vn/nganh-ke-toan-la-gi.html",
        weekness: "Nghề kế toán sẽ mang đến cảm giác khô khan. \nBắt buộc phải có bằng cấp, chứng chỉ. \nDễ bị stress.",
    },
    {
        animated_icon: "https://lottie.host/ee6d063e-ec3b-41e3-81d3-dae00ae638ea/irjQPUip7x.json",
        description: "Ngành Mạng máy tính & Truyền thông dữ liệu là một ngành phù hợp cho những bạn ham thích khám phá công nghệ, giao tiếp với nhiều người trên khắp hành tinh mà chỉ cần thông qua chiếc máy tính có kết nối mạng. Đồng thời, với những hiểu biết về mạng máy tính, các bạn có thể xây dựng được cho mình một không gian chuyên môn của mình trên Internet.",
        name: "Truyền thông Mạng máy tính",
        strength: "Cơ hội nghề nghiệp mở rộng. \nLợi nhuận cao. \nPhát triển nhanh chóng nhờ công nghệ ngày càng đi lên. \nNhu cầu tuyển dụng cao.",
        type: "network",
        url: "https://www.viendong.edu.vn/d71163719226-nganh-truyen-thong-va-mang-may-tinh-1.html",
        weekness: "Áp lực cần sự chính xác. \nLiên tục học hỏi. \nBảo mật luôn là ưu tiên. \nCần kỹ năng tương tác xã hội. \nYêu cầu khả năng giải quyết vấn đề."
    },
    {
        animated_icon: "https://lottie.host/ebdd146f-dc48-444b-aaff-afe43f56c55f/QoRgZCs9wo.json",
        description: "Điều dưỡng là một trong những ngành trong hệ thống y tế nhằm nâng cao, bảo vệ, cải thiện sức khỏe con người, xoa dịu nỗi đau qua các chẩn đoán, tư vấn về các vấn đề liên quan đến y học để tạo nên những dịch vụ về chăm sóc sức khỏe cho cá nhân, cộng đồng xã hội.",
        name: "Điều dưỡng",
        strength: "Thiếu hụt nguồn nhân lực. \nCó mức thu nhập ổn định. \nCơ hội thăng tiến. \nCó nhiều chuyên ngành để lựa chọn học. \nLàm việc được ở nhiều vị trí khác nhau.",
        type: "nursing",
        url: "https://www.viendong.edu.vn/nganh-dieu-duong-hoc-nhung-gi-ra-truong-lam-gi.html",
        weekness: "Ngành điều dưỡng bận rộn, vất vả. \nNhiều áp lực. \nRủi ro nghề nghiệp."
    },
    {
        animated_icon: "https://lottie.host/37f55cc2-2aa6-484d-a4ac-af211b9c4462/UGYrOI5Y1y.json",
        description: "Nếu hỏi về định hướng nghề nghiệp và đào tạo ngành điện, thì câu trả lời gần như chắc chắn hầu hết các trường đào tạo về kỹ thuật tại Việt Nam đều có ngành điện. Lý do là ở cái thời buổi công nghiệp hóa này, gần như tất cả mọi ngành nghề đều liên quan đến điện nên nhu cầu nhân lực về ngành điện luôn có nhiều. Ngành điện điện tử (cùng với ngành điện công nghiệp) luôn là hai ngành luôn có mọi trường về kỹ thuật có đào tạo về ngành điện.",
        name: "Điện - Điện tử",
        strength: "Sự phổ biến của công nghệ. \nSáng tạo và phát triển nhanh chóng. \nQuy mô lớn. \nQuan trọng đối với các quốc gia đang phát triển.",
        type: "electronic",
        url: "https://www.viendong.edu.vn/nganh-cong-nghe-ky-thuat-dien-kham-pha-va-tim-hieu.html",
        weekness: "Quy trình sản xuất cần năng lượng lớn. \nRủi ro an sinh xã hội. \nTính độc quyền về thị trường. \nĐộ phức tạp của công nghệ và thiết bị."
    },
    {
        animated_icon: "https://lottie.host/6449fd95-5435-428b-b3a2-fe3b5e8f5c57/cwo4ILVAvt.json",
        description: "Quản trị kinh doanh là một ngành đào tạo tất cả các kỹ năng, kiến thức cần thiết để có thể làm việc, thành lập và vận hành một doanh nghiệp hiệu quả, bất kể là dạng doanh nghiệp tư nhân, nhà nước, chính phủ hay phi chính phủ. Bạn sẽ được học về cách thức vận hành và hoạt động của tất cả các phòng ban, mọi bộ phận trong một công ty như tài chính, hành chính, marketing, kế toán, sản xuất, hậu cần…",
        name: "Quản trị kinh doanh",
        strength: "Có cơ hội việc làm cao. \nCó thể bắt đầu sự nghiệp kinh doanh riêng. \nMở rộng nhiều mối quan hệ",
        type: "business",
        url: "https://www.viendong.edu.vn/d71163839424-nganh-quan-tri-kinh-doanh-hoc-gi-o-dau-va-co-hoi-nghe-nghiep.html",
        weekness: "Bắt buộc người học phải chăm chỉ, thực hành bài học. \nBắt buộc chịu đựng được áp lực cao. \nYêu cầu người học phải chủ động xử lý tình huống. \nCó quá nhiều trường đào tạo ngành Quản trị kinh doanh.",
    },
    {
        animated_icon: "https://lottie.host/c008cf6f-416c-4d78-af98-4ae22bbcb050/BPUpLJXKMx.json",
        description: "Logistics thường được dịch là “hậu cần” nhưng cách gọi này không còn phù hợp trong xã hội hiện đại. Diễn giải một cách đơn giản và đúng với thời cuộc thì logistics nghĩa là “lưu trữ, đóng gói và vận chuyển hàng hóa từ nơi này tới nơi khác”, tức là dịch vụ vận chuyển hàng một cách tối ưu từ nơi cung cấp/sản xuất đến tay người tiêu dùng.",
        name: "Logistics",
        strength: "Các doanh nghiệp, công ty Logistics ra đời ngày càng đông, cải thiện về chất lượng, dịch vụ. \nCơ sở hạ tầng đang được cải thiện và ngày một hoàn thiện. \Sự phát triển của thương mại điện tử.",
        type: "logistic",
        url: "https://www.viendong.edu.vn/nhung-yeu-to-de-thanh-cong-trong-nganh-logistics.html",
        weekness: "Nguồn nhân lực và đào tạo còn hạn chế. \nChi phí cho các trang thiết bị phục vụ cho các nhu cầu làm hàng còn cao và chi phí bảo trì các trang thiết bị. \nQuản lý chuỗi cung ứng phức tạp. \nCạnh tranh gay gắt.nhu cầu và mong đợi của khách hàng thay đổi."
    },
    {
        animated_icon: "https://lottie.host/e1409e9e-4ae4-48c7-aa26-c8507093d37e/GKJyDKi58U.json",
        description: "Ngành Quản trị Nhà hàng - Khách sạn là một trong những ngành học rất được ưa chuộng và được đánh giá là ngành học không bao giờ 'lỗi thời', đặc biệt là trong thời đại 4.0 hiện nay. Công việc càng áp lực, bận rộn thì nhu cầu nghỉ dưỡng cũng ngày càng cao, đó chính là một trong những nguyên nhân thúc đẩy nhóm ngành quản trị nhà hàng khách sạn ngày một phát triển.",
        name: "Nhà hàng - Khách sạn",
        strength: "Trưởng thành về mặt tính cách và tư duy sáng tạo. \nĐược trải nghiệm nhiều nền văn hóa và phong tục khác nhau. \nVô vàn cơ hội việc làm. \nCó cơ hội phát triển bản thân. \nNăng lực làm việc cao.",
        type: "restaurant",
        url: "https://www.viendong.edu.vn/nganh-quan-tri-nha-hang-khach-san-hoc-nhung-gi-ra-truong-lam-gi.html",
        weekness: "Không có thời gian làm việc cố định. \nKhả năng thăng tiến trong công việc thấp. \nThái độ trong công việc. \nYêu cầu ngoại ngữ. \nMức lương khởi điểm thấp."
    },
    {
        animated_icon: "https://lottie.host/0b3f5b5e-a30a-4e12-804b-a07519cc0158/TtqYJnAyr3.json",
        description: "Ngành chăm sóc sắc đẹp là ngành đào tạo các kĩ năng điều trị, các phương pháp kĩ thuật sử dụng các công cụ dụng cụ để làm đẹp cho con người. Ngành chăm sóc sắc đẹp phát triển đáp ứng nhu cầu thị trường hiện nay với các chuyên ngành giảng dạy như: spa, nail, mi, phun xăm thẩm mỹ, tạo mẫu tóc, trang điểm nghệ thuật và một số kỹ thuật khác.",
        name: "Chăm sóc sắc đẹp",
        strength: "Nhanh có việc. \nThu nhập cao, tăng theo từng năm. \n Nhu cầu lớn. \nChi phí học thấp.",
        type: "beauticare",
        url: "https://www.viendong.edu.vn/d71163925764-cham-soc-sac-dep-101-dieu-sv-can-biet-ve-nganh.html",
        weekness: "Thị trường cạnh tranh cao. \nThời gian học ngắn. \nDễ mệt mỏi và chán nản. \nPhải đáp ứng nhu cầu của nhiều đối tượng khách hàng. \nPhục thuộc vào yếu tố khách quan."
    },
    {
        animated_icon: "https://lottie.host/5b026c42-1f89-49f3-9cf8-809eb1247fe1/MonmUfyY1T.json",
        description: "Ngành Cơ khí là một ngành học đóng vai trò cực kỳ quan trọng đối với sự phát triển của kinh tế và xã hội. Để máy móc và các thiết bị phục vụ trong quá trình sản xuất sản phẩm có thể hoạt động tốt thì cần đến sự tham gia của các kỹ sư cơ khí.",
        name: "Cơ khí",
        strength: "Độ cần thiết cao trong nền kinh tế. \nPhạm vi công việc rộng. \nLinh họa trong công việc. \nThu nhập cao.",
        type: "mechanic",
        url: "https://www.viendong.edu.vn/d71163735066-nganh-cong-nghe-co-khi-linh-vuc-day-tiem-nang-1.html",
        weekness: "Khả năng đào tạo cao. \nTính cạnh tranh cao. \Áp lực về thời gian. \nCông việc cần sự chính xác cao."
    },
    {
        animated_icon: "https://lottie.host/1f1a035e-c8d8-4dea-8eef-10d952b2a83d/dungZITt6p.json",
        description: "Lập trình ứng dụng là những chuyên viên lập trình về công nghệ di động, website, v.v. Ngành sử dụng ngôn ngữ lập trình (Java, C#,..) để viết, sáng tạo và phát triển các phần mềm nhằm gia tăng tiện ích cho thiết bị di động.",
        name: "Lập trình ứng dụng",
        strength: "Thu nhập hấp dẫn. \nCơ hội nghề nghiệp rộng mở. \nMôi trường làm việc linh hoạt. \nCông việc mang tính toàn cầu.",
        type: "programing",
        url: "https://www.viendong.edu.vn/d7153928887-nganh-cong-nghe-thong-tin-lap-trinh-ung-dung.html",
        weekness: "Công nghệ thay đổi liên tục – Đòi hỏi sự nhạy bén. \nLương cao đi đôi với áp lực. \nTiềm ẩn rủi ro về sức khỏe."
    }
]

// An object for a Quiz, which will contain Question objects.
var Quiz = function (quiz_name) {
    // Private fields for an instance of a Quiz object.
    this.quiz_name = quiz_name;

    // This one will contain an array of Question objects in the order that the questions will be presented.
    this.questions = [];
};

let answers = [];

// A function that you can enact on an instance of a quiz object. This function is called add_question() and takes in a Question object which it will add to the questions field.
Quiz.prototype.add_question = function (question) {
    // Randomly choose where to add question
    var index_to_add_question = Math.floor(Math.random() * this.questions.length);
    this.questions.splice(index_to_add_question, 0, question);
};

// A function that you can enact on an instance of a quiz object. This function is called render() and takes in a variable called the container, which is the <div> that I will render the quiz in.
Quiz.prototype.render = function (container) {
    // For when we're out of scope
    var self = this;

    // Hide the quiz results modal
    document.getElementById('quiz-results').style.display = 'none';

    // Write the name of the quiz
    document.getElementById('quiz-name').textContent = this.quiz_name;

    // Create a container for questions
    var question_container = document.createElement('div');
    question_container.id = 'question';
    question_container.className = 'd-flex align-items-center justify-content-center gap-2 flex-column';
    container.insertAdjacentElement('afterend', question_container);


    // Helper function for changing the question and updating the buttons
    function change_question() {
        self.questions[current_question_index].render(question_container);
        document.getElementById('prev-question-button').disabled = current_question_index === 0;
        document.getElementById('next-question-button').disabled = current_question_index === self.questions.length - 1;

        // Determine if all questions have been answered
        var all_questions_answered = true;
        for (var i = 0; i < self.questions.length; i++) {
            if (self.questions[i].user_choice_index === null) {
                all_questions_answered = false;
                break;
            }
        }
        document.getElementById('submit-button').disabled = !all_questions_answered;
    }

    // Render the first question
    var current_question_index = 0;
    change_question();

    // Add listener for the previous question button
    document.getElementById('prev-question-button').addEventListener('click', function () {
        if (current_question_index > 0) {
            current_question_index--;
            change_question();
        }
    });

    // Add listener for the next question button
    document.getElementById('next-question-button').addEventListener('click', function () {
        if (current_question_index < self.questions.length - 1) {
            current_question_index++;
            change_question();
        }
    });

    // Add listener for the submit answers button
    document.getElementById('submit-button').addEventListener('click', function () {
        var loader = document.getElementById('loader-container');
        var questionC = document.getElementById('question-container');

        loader.classList.remove('hidden');
        questionC.classList.add('hidden');

        setTimeout(async () => {
            loader.classList.add('hidden');

            if (answers.length <= 0) {
                alert("Hãy làm bài trước khi nộp!!!");
                return;
            }

            const result = calculatePoint(answers);
            const body = {
                studentCode,
                name,
                birthday,
                result: calculateScore(answers)
            };

            const isSuccess = await postData(body)

            if (!isSuccess) {
                alert("Lỗi hệ thống");
                return;
            }

            const main_career = careers.find(x => x.type === result.highestTypes);
            questionC.classList.remove('hidden');

            // Display the score with the appropriate message
            document.getElementById('quiz-results-message').textContent = "Chúc mừng hoàn thành trắc nghiệm";
            document.getElementById('quiz-results-score').innerHTML = 'Bạn phù hợp với ngành <b>' + main_career.name + '</b>.';
            document.getElementById('quiz-results').style.display = 'flex';
            document.getElementById('submit-button').style.display = 'none';
            document.getElementById('next-question-button').style.display = 'none';
            document.getElementById('prev-question-button').style.display = 'none';
            document.getElementById('quiz-retry-button').style.display = 'block';
            document.getElementById('lottie-container').innerHTML = `
                <lottie-player id="lottiePlayer" background="transparent" speed="1"
                        src="${main_career.animated_icon}"
                        style="width: 150px; height: 150px;" loop autoplay class="m-auto py-2">
                </lottie-player>
            `;
            document.getElementById('description').innerHTML = main_career.description;
            document.getElementById('strength').innerHTML = main_career.strength.split('\n').map(function (sentence) {
                return '&emsp;&emsp;' + sentence.trim(); // Dùng &emsp; để thêm gạch đầu dòng
            }).join('<br>');
            document.getElementById('weekness').innerHTML = main_career.weekness.split('\n').map(function (sentence) {
                return '&emsp;&emsp;' + sentence.trim(); // Dùng &emsp; để thêm gạch đầu dòng
            }).join('<br>');
            document.getElementById('url').innerHTML = `
                <a href=${main_career.url}>Tại đây</a>
            `

            document.getElementById('quiz-retry-button').addEventListener('click', function () {
                window.location.reload();
            });
        }, 2000);
    });

    // Add a listener on the questions container to listen for user select changes. This is for determining whether we can submit answers or not.
    question_container.addEventListener('user-select-change', function () {
        var all_questions_answered = true;
        for (var i = 0; i < self.questions.length; i++) {
            if (self.questions[i].user_choice_index === null) {
                all_questions_answered = false;
                break;
            }
        }
        document.getElementById('submit-button').disabled = !all_questions_answered;
    });
}

function calculateScore(answers) {
    let grouped = {};

    answers.forEach(item => {
        let { type, value } = item;

        let score = 0;
        switch (value) {
            case 'yes':
                score = 2;
                break;
            case 'notyet':
                score = 1;
                break;
            case 'no':
                score = 0;
                break;
            default:
                score = 0;
        }

        if (grouped[type]) {
            grouped[type].score += score;
        } else {
            grouped[type] = { type, score };
        }
    });

    let result = Object.values(grouped);

    return result;
}


function calculatePoint(answers) {
    let scores = {};

    answers.forEach(item => {
        let type = item.type;
        let value = item.value;

        if (!scores[type]) {
            scores[type] = 0;
        }

        if (value === "yes") {
            scores[type] += 2;
        } else if (value === "notyet") {
            scores[type] += 1;
        } else if (value === "no") {
            scores[type] += 0;
        }
    });

    let highestTypes = [];
    let highestScore = -Infinity;

    for (let type in scores) {
        if (scores[type] > highestScore) {
            highestScore = scores[type];
            highestTypes = [type];
        } else if (scores[type] === highestScore) {
            highestTypes.push(type);
        }
    }

    return { highestTypes: highestTypes[0], highestScore };
}

// An object for a Question, which contains the question, the correct choice, and wrong choices. This block is the constructor.
var Question = function (question_string, options, type) {
    // Private fields for an instance of a Question object.
    this.question_string = question_string;
    this.choices = options;
    this.career_type = type;
    this.user_choice_index = null; // Index of the user's choice selection
}

// A function that you can enact on an instance of a question object. This function is called render() and takes in a variable called the container, which is the <div> that I will render the question in. This question will "return" with the score when the question has been answered.
Question.prototype.render = function (container) {
    // For when we're out of scope
    var self = this;

    // Fill out the question label
    var question_string_h2;
    if (container.querySelector('h2') === null) {
        question_string_h2 = document.createElement('h2');
        container.appendChild(question_string_h2);
    } else {
        question_string_h2 = container.querySelector('h2');
    }
    question_string_h2.textContent = this.question_string;

    // Clear any radio buttons and create new ones
    container.innerHTML = '';
    container.appendChild(question_string_h2);

    for (var i = 0; i < this.choices.length; i++) {
        // Create the radio button
        var choice_radio_button = document.createElement('input');
        choice_radio_button.id = 'choices-' + i;
        choice_radio_button.type = 'radio';
        choice_radio_button.name = 'choices';
        choice_radio_button.value = this.choices[i].value;
        choice_radio_button.checked = i === this.user_choice_index;
        container.appendChild(choice_radio_button);

        // Create the label
        var choice_label = document.createElement('label');
        choice_label.textContent = this.choices[i].text;
        choice_label.htmlFor = 'choices-' + i;
        container.appendChild(choice_label);

        // Add a listener for the radio button to change which one the user has clicked on
        choice_radio_button.addEventListener('change', function (event) {
            var selected_radio_button_value = event.target.value;

            var answer = {
                type: self.career_type,
                value: selected_radio_button_value
            };

            answers.push(answer);

            // Change the user choice index
            self.user_choice_index = parseInt(selected_radio_button_value.substr(selected_radio_button_value.length - 1, 1));

            // Trigger a user-select-change
            var userSelectChangeEvent = new Event('user-select-change');
            container.dispatchEvent(userSelectChangeEvent);
        });
    }
}

async function onLoadData() {
    const response = await fetch('/api/career/getQuestion')
        .then(response => {
            // Kiểm tra nếu response không thành công (không thành công khi status không nằm trong khoảng 200-299)
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            // Trả về response dưới dạng JSON
            return response.json();
        })
        .then(data => {
            if (data && data.status) {
                return data.payload;
            }
            return [];
            // "Main method" which will create all the objects and render the Quiz.
        })
        .catch(error => {
            // Xử lý lỗi nếu có
            console.error('Fetch error:', error);
        });
    return response;
}

async function postData(data) {
    const response = await fetch('/api/career/postResult', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
        .then(response => {
            // Kiểm tra nếu response không thành công (không thành công khi status không nằm trong khoảng 200-299)
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            // Trả về response dưới dạng JSON
            return response.json();
        })
        .then(data => {
            if (data) {
                return data.status;
            }
            return false;
        })
        .catch(error => {
            // Xử lý lỗi nếu có
            console.error('Fetch error:', error);
        });
    return response;
}

function isOver13YearsOld(birthdayStr) {
    let birthday = new Date(birthdayStr);

    if (isNaN(birthday.getTime())) {
        throw new Error('Ngày sinh không hợp lệ.');
    }

    let today = new Date();

    let age = today.getFullYear() - birthday.getFullYear();

    let monthDiff = today.getMonth() - birthday.getMonth();
    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthday.getDate())) {
        age--;
    }

    return age >= 13;
}

let studentCode = '';
let name = '';
let birthday = '';

document.addEventListener('DOMContentLoaded', async function () {
    document.getElementById('btnSubmit').addEventListener('click', function (event) {

        studentCode = document.getElementById('student-code').value.trim();
        name = document.getElementById('name').value.trim();
        birthday = document.getElementById('birthday').value.trim();

        // Kiểm tra các giá trị
        if (!studentCode || studentCode === "" || !name || name === "" || !birthday || birthday === "") {
            alert('Vui lòng nhập đầy đủ thông tin.');
            event.preventDefault(); // Ngăn chặn form được submit
            return;
        }

        if (!isOver13YearsOld(birthday)) {
            alert('Bạn không được nhỏ hơn 13 tuổi.');
            event.preventDefault(); // Ngăn chặn form được submit
            return;
        }

        document.getElementById("info-form").classList.add("hidden");
        document.getElementById('quiz').classList.remove("hidden");

    });

    document.getElementById('birthday').addEventListener('click', function () {
        this.type = 'date';
        setTimeout(() => {
            this.showPicker();
        }, 0);
    });

    document.getElementById('birthday').addEventListener('blur', function () {
        if (this.value === '') {
            this.type = 'text';
        }
    });

    const datas = await onLoadData();

    // Create an instance of the Quiz object
    var quiz = new Quiz('Định hướng ngành nghề');

    // Create Question objects from all_questions and add them to the Quiz object
    if (datas.length > 0) {
        for (var i = 0; i < datas.length; i++) {
            // Create a new Question object
            var question = new Question(datas[i].text, datas[i].options, datas[i].type);

            // Add the question to the instance of the Quiz object that we created previously
            quiz.add_question(question);
        }

        // Render the quiz
        var quiz_container = document.getElementById('question-area');
        quiz.render(quiz_container);
    }
});